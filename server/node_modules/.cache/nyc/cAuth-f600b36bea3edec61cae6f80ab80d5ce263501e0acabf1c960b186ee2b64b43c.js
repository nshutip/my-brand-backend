function cov_162uiwl1c0(){var path="/Users/nshutip/Desktop/Andela/my-brand-backend/server/middleware/cAuth.js";var hash="dd9436f35509c1a2b85ad94a4626e9ecd7ca74e1";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/nshutip/Desktop/Andela/my-brand-backend/server/middleware/cAuth.js",statementMap:{"0":{start:{line:1,column:21},end:{line:1,column:44}},"1":{start:{line:2,column:13},end:{line:2,column:43}},"2":{start:{line:4,column:19},end:{line:4,column:85}},"3":{start:{line:6,column:20},end:{line:24,column:1}},"4":{start:{line:7,column:16},end:{line:7,column:45}},"5":{start:{line:9,column:2},end:{line:9,column:20}},"6":{start:{line:11,column:2},end:{line:11,column:84}},"7":{start:{line:11,column:14},end:{line:11,column:84}},"8":{start:{line:13,column:2},end:{line:23,column:3}},"9":{start:{line:14,column:20},end:{line:14,column:58}},"10":{start:{line:15,column:17},end:{line:15,column:61}},"11":{start:{line:17,column:4},end:{line:17,column:73}},"12":{start:{line:17,column:15},end:{line:17,column:73}},"13":{start:{line:19,column:4},end:{line:19,column:19}},"14":{start:{line:20,column:4},end:{line:20,column:11}},"15":{start:{line:22,column:4},end:{line:22,column:49}},"16":{start:{line:26,column:0},end:{line:26,column:29}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:20},end:{line:6,column:21}},loc:{start:{line:6,column:45},end:{line:24,column:1}},line:6}},branchMap:{"0":{loc:{start:{line:11,column:2},end:{line:11,column:84}},type:"if",locations:[{start:{line:11,column:2},end:{line:11,column:84}},{start:{line:11,column:2},end:{line:11,column:84}}],line:11},"1":{loc:{start:{line:17,column:4},end:{line:17,column:73}},type:"if",locations:[{start:{line:17,column:4},end:{line:17,column:73}},{start:{line:17,column:4},end:{line:17,column:73}}],line:17}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0},f:{"0":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"dd9436f35509c1a2b85ad94a4626e9ecd7ca74e1"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_162uiwl1c0=function(){return actualCoverage;};}return actualCoverage;}cov_162uiwl1c0();const jsonwebtoken=(cov_162uiwl1c0().s[0]++,require("jsonwebtoken"));const User=(cov_162uiwl1c0().s[1]++,require("../models/userModel"));const JWT_SECRET=(cov_162uiwl1c0().s[2]++,"goK!pusp6ThEdURUtRenOwUhAsWUCLheBazl!uJLPlS8EbreWLdrupIwabRAsiBu");cov_162uiwl1c0().s[3]++;const verifyToken=async(req,res,next)=>{cov_162uiwl1c0().f[0]++;const token=(cov_162uiwl1c0().s[4]++,req.headers["x-access-token"]);cov_162uiwl1c0().s[5]++;console.log(token);cov_162uiwl1c0().s[6]++;if(!token){cov_162uiwl1c0().b[0][0]++;cov_162uiwl1c0().s[7]++;return res.status(403).send("A token is required for authentication");}else{cov_162uiwl1c0().b[0][1]++;}cov_162uiwl1c0().s[8]++;try{const decoded=(cov_162uiwl1c0().s[9]++,jsonwebtoken.verify(token,JWT_SECRET));const user=(cov_162uiwl1c0().s[10]++,await User.findOne({_id:decoded.user_id}));cov_162uiwl1c0().s[11]++;if(!user){cov_162uiwl1c0().b[1][0]++;cov_162uiwl1c0().s[12]++;return res.status(404).send({error:"User not found!"});}else{cov_162uiwl1c0().b[1][1]++;}cov_162uiwl1c0().s[13]++;req.user=user;cov_162uiwl1c0().s[14]++;next();}catch{cov_162uiwl1c0().s[15]++;return res.status(401).send("Invalid Token");}};cov_162uiwl1c0().s[16]++;module.exports=verifyToken;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJqc29ud2VidG9rZW4iLCJyZXF1aXJlIiwiVXNlciIsIkpXVF9TRUNSRVQiLCJ2ZXJpZnlUb2tlbiIsInJlcSIsInJlcyIsIm5leHQiLCJ0b2tlbiIsImhlYWRlcnMiLCJjb25zb2xlIiwibG9nIiwic3RhdHVzIiwic2VuZCIsImRlY29kZWQiLCJ2ZXJpZnkiLCJ1c2VyIiwiZmluZE9uZSIsIl9pZCIsInVzZXJfaWQiLCJlcnJvciIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlcyI6WyJjQXV0aC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBqc29ud2VidG9rZW4gPSByZXF1aXJlKFwianNvbndlYnRva2VuXCIpO1xuY29uc3QgVXNlciA9IHJlcXVpcmUoXCIuLi9tb2RlbHMvdXNlck1vZGVsXCIpXG5cbmNvbnN0IEpXVF9TRUNSRVQgPSBcImdvSyFwdXNwNlRoRWRVUlV0UmVuT3dVaEFzV1VDTGhlQmF6bCF1SkxQbFM4RWJyZVdMZHJ1cEl3YWJSQXNpQnVcIjtcblxuY29uc3QgdmVyaWZ5VG9rZW4gPSBhc3luYyhyZXEsIHJlcywgbmV4dCkgPT4ge1xuICBjb25zdCB0b2tlbiA9IHJlcS5oZWFkZXJzW1wieC1hY2Nlc3MtdG9rZW5cIl07XG5cbiAgY29uc29sZS5sb2codG9rZW4pXG5cbiAgaWYgKCF0b2tlbikgcmV0dXJuIHJlcy5zdGF0dXMoNDAzKS5zZW5kKFwiQSB0b2tlbiBpcyByZXF1aXJlZCBmb3IgYXV0aGVudGljYXRpb25cIik7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBkZWNvZGVkID0ganNvbndlYnRva2VuLnZlcmlmeSh0b2tlbiwgSldUX1NFQ1JFVCk7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZE9uZSh7IF9pZDogZGVjb2RlZC51c2VyX2lkIH0pO1xuXG4gICAgaWYgKCF1c2VyKSByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoeyBlcnJvcjogXCJVc2VyIG5vdCBmb3VuZCFcIiB9KTtcblxuICAgIHJlcS51c2VyID0gdXNlclxuICAgIG5leHQoKTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5zZW5kKFwiSW52YWxpZCBUb2tlblwiKTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB2ZXJpZnlUb2tlbjsiXSwibWFwcGluZ3MiOiI4ckVBZVk7QUFBQSwyRkFmWixLQUFNQSxhQUFZLDBCQUFHQyxPQUFPLENBQUMsY0FBYyxDQUFDLEVBQzVDLEtBQU1DLEtBQUksMEJBQUdELE9BQU8sQ0FBQyxxQkFBcUIsQ0FBQyxFQUUzQyxLQUFNRSxXQUFVLDBCQUFHLGtFQUFrRSxFQUFDLHdCQUV0RixLQUFNQyxZQUFXLENBQUcsTUFBTUMsR0FBRyxDQUFFQyxHQUFHLENBQUVDLElBQUksR0FBSyx5QkFDM0MsS0FBTUMsTUFBSywwQkFBR0gsR0FBRyxDQUFDSSxPQUFPLENBQUMsZ0JBQWdCLENBQUMsRUFBQyx3QkFFNUNDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDSCxLQUFLLENBQUMseUJBRWxCLEdBQUksQ0FBQ0EsS0FBSyxDQUFFLDBEQUFPRixJQUFHLENBQUNNLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLHdDQUF3QyxDQUFDLEVBQUMseURBRWxGLEdBQUksQ0FDRixLQUFNQyxRQUFPLDBCQUFHZCxZQUFZLENBQUNlLE1BQU0sQ0FBQ1AsS0FBSyxDQUFFTCxVQUFVLENBQUMsRUFDdEQsS0FBTWEsS0FBSSwyQkFBRyxLQUFNZCxLQUFJLENBQUNlLE9BQU8sQ0FBQyxDQUFFQyxHQUFHLENBQUVKLE9BQU8sQ0FBQ0ssT0FBUSxDQUFDLENBQUMsRUFBQyx5QkFFMUQsR0FBSSxDQUFDSCxJQUFJLENBQUUsMkRBQU9WLElBQUcsQ0FBQ00sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsQ0FBRU8sS0FBSyxDQUFFLGlCQUFrQixDQUFDLENBQUMsRUFBQywwREFFckVmLEdBQUcsQ0FBQ1csSUFBSSxDQUFHQSxJQUFJLDBCQUNmVCxJQUFJLEVBQUUsQ0FDUixDQUFFLEtBQU0sMEJBQ04sTUFBT0QsSUFBRyxDQUFDTSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxlQUFlLENBQUMsQ0FDOUMsQ0FDRixDQUFDLENBQUMseUJBRUZRLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHbEIsV0FBVyJ9